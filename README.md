# ESXi Info

* A simple Bash program for retrieving basic information from ESXi hosts and writing the information into a HTML file.
* The program can connect both free and licensed ESXi hosts.
* The project has been tested on couple different Linux distros and Windows Subsystem Linux.

## Example use cases
1. Mikko has 4 servers running ESXI hypervisors. Some virtual machines shutdown and some powered on. Mikko's household has power outage. After getting power back Mikko can easily check from the HTML file generated by this program what was running on which ESXi hosts.
1. Olavi has 3 servers running ESXi hypervisors. Olavi is not sure which ESXi host has free memory and storage. Olavi can easily check from the generated HTML file which host(s) have free resources.

## How to use
1. Clone the repo in shell. If you want the HTML file to be easily accessed in Windows, it might be good idea to use path similar to `/mnt/c/something`.
    ~~~
    git clone https://github.com/iisti/esxi_info.git
    ~~~
1. Edit config.conf file
    * Add the hostnames/IPs of ESXis.
    * (Optional) Add the paths of your SSH keys, both private and public.

### Automation
* You can automate program to run perodically by creating SSH keys for connecting to the ESXi hosts and creating a cronjob for running the program perodically. 

1. Create SSH keys, for example with command below
    ~~~
    sudo ssh-keygen -t rsa -b 4096 -C "user_or_whatever_is_wanted_for_identifying_the_key"
    ~~~
1. Add the SSH keys to authorized_keys list on ESXis by running script **add_sshkey_to_esxi.bash** or you can add them manually also.
      
1. Add to crontab, change the paths to whatever suits. This example is run on WSL.
    ~~~
    # You can also use some other text editor than vim, like nano.
    sudo vim /etc/crontab
    
    # Line to add to crontab
    21 15 * * * root sudo /mnt/c/esxi_info/get_esxi_info.bash > /mnt/c/esxi_info/logs/log.txt
    #
    ~~~
1. If using WSL (Windows Subsystem Linux), remember to start cron! One needs to have the WSL running all the time!
    ~~~
    # Start cron
    sudo service cron start
    # Check that cron is running
    pgrep cron
    ~~~
